#ifndef MLP_MODEL_ESP32_H
#define MLP_MODEL_ESP32_H

// MLP model exportat pentru ESP32
// Acurate»õe: 100.00%

#define N_IN 83
#define H1 16
#define H2 8
#define N_OUT 4

float w1[16][83] = {
  {-0.291394f, -0.210597f, -0.106719f, -0.087771f, -0.086424f, 0.047448f, 0.188592f, -0.036677f, -0.122296f, 0.178613f, -0.197233f, 0.407922f, 0.177915f, -0.316680f, -0.057245f, 0.084071f, 0.033466f, 0.196279f, -0.069628f, -0.237719f, -0.181770f, -0.056923f, 0.034002f, -0.053753f, 0.143116f, -0.016346f, -0.123729f, 0.135778f, 0.026748f, -0.157696f, 0.239695f, 0.362064f, 0.034718f, -0.118910f, -0.071912f, 0.202506f, 0.082420f, 0.189214f, -0.190942f, 0.044727f, 0.138050f, -0.038357f, -0.029872f, -0.035305f, -0.223946f, -0.184988f, 0.439782f, 0.128934f, 0.305644f, 0.247855f, 0.172549f, -0.230254f, -0.163119f, -0.279407f, -0.347957f, -0.070186f, 0.224261f, 0.138769f, -0.219313f, 0.219136f, -0.147605f, -0.085342f, 0.146084f, -0.310609f, 0.113634f, -0.092513f, -0.048969f, 0.366887f, -0.177218f, 0.238945f, 0.026191f, 0.020750f, -0.220405f, -0.311332f, -0.053641f, -0.107180f, 0.102628f, 0.427827f, 0.172695f, 0.050117f, -0.087044f, -0.041396f, -0.270453f},
  {0.060276f, -0.071145f, -0.077936f, -0.300358f, -0.010138f, -0.087894f, 0.032004f, -0.028643f, 0.299737f, 0.013410f, 0.110315f, -0.152978f, 0.237647f, 0.217878f, 0.079478f, 0.301895f, 0.066120f, -0.031745f, 0.222714f, 0.155621f, -0.134217f, -0.117398f, -0.111059f, 0.090347f, 0.190867f, -0.130576f, -0.046074f, 0.110334f, -0.113798f, 0.060080f, -0.121522f, -0.061237f, -0.092327f, 0.156905f, 0.206636f, -0.025775f, -0.152439f, -0.102564f, -0.201821f, 0.147514f, 0.332284f, 0.016680f, -0.073895f, -0.132827f, 0.098998f, 0.221997f, 0.335483f, 0.296595f, 0.059355f, 0.368726f, 0.050391f, 0.102259f, -0.066745f, -0.148219f, 0.245435f, 0.283183f, 0.289408f, 0.146009f, 0.035786f, 0.243130f, 0.221952f, 0.176784f, 0.114487f, 0.048774f, 0.058849f, -0.219379f, 0.024037f, 0.255447f, 0.124151f, -0.128340f, 0.300057f, -0.117283f, -0.032085f, -0.022776f, 0.071879f, 0.043655f, -0.059757f, 0.130979f, 0.267303f, -0.087838f, -0.067181f, 0.242371f, -0.232746f},
  {-0.029224f, 0.058359f, -0.010397f, 0.177943f, 0.028192f, -0.150190f, 0.238442f, 0.092892f, -0.147327f, 0.201836f, 0.128506f, -0.024400f, -0.110326f, -0.215463f, 0.193128f, 0.110051f, -0.181749f, 0.094064f, -0.058912f, -0.165804f, -0.094912f, -0.229120f, -0.210555f, -0.229688f, -0.146249f, -0.149626f, -0.131925f, 0.060291f, 0.139612f, -0.230886f, 0.114076f, -0.201141f, -0.217883f, -0.268822f, -0.083003f, 0.250379f, -0.229122f, 0.250290f, 0.274913f, -0.136691f, 0.048870f, 0.008581f, -0.098658f, 0.281774f, 0.054816f, 0.181172f, 0.003605f, -0.083831f, 0.185266f, 0.149760f, -0.190302f, -0.253335f, -0.128457f, -0.147924f, 0.106716f, -0.242373f, -0.034075f, 0.157387f, -0.167329f, -0.133252f, -0.136234f, -0.061546f, -0.007475f, 0.173691f, -0.142841f, -0.155420f, 0.071900f, -0.219971f, -0.147153f, -0.039013f, 0.115228f, -0.210993f, 0.128821f, -0.203684f, 0.071197f, 0.058715f, -0.113854f, -0.088351f, -0.175469f, -0.202673f, 0.003103f, 0.209986f, 0.020164f},
  {0.046660f, -0.143209f, -0.134606f, -0.102984f, -0.200371f, -0.194654f, -0.117277f, -0.286702f, -0.055354f, -0.205116f, -0.154687f, 0.074135f, -0.008395f, -0.088005f, 0.099669f, -0.388500f, -0.068051f, 0.194456f, 0.080327f, 0.085274f, 0.134636f, 0.185510f, -0.108814f, -0.261186f, -0.094231f, -0.013828f, -0.179013f, 0.108151f, -0.334872f, 0.129587f, 0.122439f, -0.018327f, -0.132968f, -0.206010f, 0.100300f, -0.116126f, -0.249579f, -0.247971f, 0.171821f, -0.188894f, -0.186861f, -0.169692f, 0.042128f, -0.159420f, 0.077193f, 0.194853f, 0.034689f, 0.285651f, -0.217539f, 0.043252f, 0.178613f, 0.092756f, -0.075824f, -0.288040f, -0.369975f, -0.120921f, -0.277947f, 0.110731f, -0.068541f, -0.191635f, -0.387264f, -0.454874f, -0.336284f, -0.152214f, -0.037621f, -0.334534f, 0.160476f, 0.152900f, -0.159972f, -0.089568f, -0.111231f, -0.226310f, 0.154045f, -0.140577f, -0.264519f, -0.048954f, 0.261764f, 0.201563f, -0.064680f, 0.227281f, 0.013625f, 0.189278f, 0.145095f},
  {-0.044648f, 0.166865f, -0.181438f, -0.152542f, -0.164633f, -0.247018f, -0.084410f, -0.079953f, -0.307006f, -0.374293f, -0.025627f, 0.098825f, 0.132937f, -0.305690f, -0.302945f, 0.041440f, -0.098875f, -0.081628f, -0.319490f, 0.025375f, -0.173756f, -0.178104f, 0.214957f, 0.215471f, -0.035086f, 0.098226f, 0.102553f, 0.125296f, -0.240003f, -0.327829f, -0.310711f, 0.173459f, -0.002243f, -0.226432f, 0.062610f, -0.240566f, -0.283582f, -0.290122f, 0.025674f, 0.016098f, -0.257401f, 0.004589f, -0.244509f, 0.115419f, -0.069893f, -0.318403f, 0.142627f, -0.203085f, 0.163437f, -0.090297f, -0.033792f, -0.016568f, 0.067060f, 0.019304f, -0.192560f, -0.170898f, -0.253468f, -0.180680f, 0.072005f, 0.129850f, -0.318799f, -0.415537f, -0.158255f, -0.262861f, -0.218576f, -0.049450f, -0.244090f, -0.048270f, -0.224204f, -0.379189f, -0.058542f, -0.148312f, -0.069276f, -0.102760f, 0.038022f, 0.033796f, 0.011076f, -0.051396f, -0.323422f, -0.237423f, -0.004966f, -0.335728f, -0.270148f},
  {0.373751f, 0.097300f, 0.307337f, 0.118017f, -0.185681f, 0.069275f, -0.381137f, 0.095688f, -0.322363f, -0.126602f, -0.244390f, 0.258307f, 0.032586f, 0.066412f, -0.152614f, 0.036263f, -0.179146f, -0.408942f, -0.418569f, -0.383076f, -0.056598f, -0.151947f, -0.029801f, -0.089440f, -0.156350f, 0.016153f, 0.029997f, 0.151445f, -0.391950f, -0.170471f, -0.360649f, 0.082376f, -0.134204f, 0.154433f, 0.039620f, -0.325719f, -0.150806f, -0.264295f, -0.353864f, -0.034151f, -0.268505f, -0.013989f, 0.041955f, -0.108995f, -0.167488f, -0.029565f, 0.140337f, 0.300897f, 0.113284f, -0.103039f, 0.001928f, -0.394356f, -0.138244f, -0.100985f, -0.171658f, 0.011721f, -0.209965f, -0.245377f, -0.081369f, -0.042031f, -0.288264f, -0.358400f, -0.162449f, -0.163613f, -0.406556f, -0.213911f, -0.089165f, -0.007183f, -0.037526f, 0.069038f, -0.057380f, -0.381551f, -0.073454f, 0.004864f, -0.291961f, 0.017768f, -0.321841f, 0.068944f, -0.324283f, -0.241859f, 0.021747f, 0.087487f, -0.100429f},
  {-0.224677f, 0.141168f, 0.174834f, -0.052911f, 0.317986f, 0.433099f, 0.338708f, 0.078265f, 0.360526f, -0.082172f, 0.369104f, 0.359933f, 0.448071f, 0.018928f, -0.071042f, -0.048673f, 0.236559f, 0.082924f, 0.225870f, 0.460614f, 0.237813f, 0.274096f, -0.037177f, 0.190780f, 0.237716f, 0.105715f, 0.175513f, -0.113352f, 0.123681f, 0.353739f, 0.228659f, -0.130395f, -0.004480f, -0.064323f, 0.248907f, -0.001862f, 0.130501f, 0.092156f, -0.021091f, 0.357122f, 0.106903f, 0.327181f, 0.255942f, 0.178266f, 0.217448f, -0.034525f, 0.219934f, 0.000644f, 0.377072f, -0.029389f, 0.490442f, 0.127702f, 0.110829f, 0.213074f, 0.264971f, 0.303675f, 0.426487f, -0.034501f, -0.096079f, -0.051867f, 0.318590f, 0.422023f, 0.354613f, 0.404114f, 0.144929f, 0.262900f, 0.325795f, 0.078987f, -0.093091f, 0.174820f, 0.110053f, 0.176236f, 0.065144f, 0.135108f, 0.158368f, 0.183457f, -0.012226f, 0.256937f, 0.285148f, 0.236387f, 0.045159f, 0.153715f, 0.177153f},
  {0.213254f, 0.152451f, 0.258151f, 0.186285f, 0.394471f, 0.310116f, 0.003358f, 0.122654f, 0.076307f, 0.265264f, 0.285880f, 0.511989f, 0.489946f, -0.047017f, 0.432476f, 0.486893f, 0.000521f, 0.016226f, 0.419513f, 0.318364f, 0.123742f, 0.340167f, 0.361752f, 0.135902f, -0.018554f, 0.004457f, 0.197463f, -0.019966f, 0.316369f, 0.134004f, 0.288078f, 0.511842f, 0.091579f, 0.421788f, 0.044118f, 0.289486f, 0.375320f, 0.010894f, 0.104326f, 0.239863f, 0.483548f, 0.045678f, 0.174290f, 0.125097f, 0.221935f, 0.136739f, 0.484632f, 0.044295f, 0.216430f, 0.380266f, 0.357995f, 0.348941f, 0.383092f, 0.289983f, 0.097704f, -0.035038f, 0.183606f, 0.283037f, 0.127993f, 0.235665f, 0.041967f, 0.101934f, 0.080774f, 0.077917f, 0.395960f, 0.217690f, 0.053906f, 0.125052f, 0.223852f, 0.522672f, 0.297626f, 0.022892f, 0.091957f, 0.425925f, 0.062284f, 0.225435f, 0.528082f, 0.402039f, 0.499915f, 0.312234f, 0.344260f, 0.302050f, 0.428434f},
  {0.159356f, -0.080061f, 0.060125f, 0.117260f, 0.059779f, 0.080912f, -0.232169f, 0.030162f, -0.062556f, 0.036653f, -0.114511f, -0.066610f, 0.090105f, 0.201469f, 0.231637f, 0.287737f, -0.150523f, 0.180499f, 0.075520f, -0.092080f, 0.282176f, -0.227144f, 0.170514f, -0.107456f, -0.069414f, -0.172766f, -0.356708f, 0.180982f, 0.212695f, 0.045198f, -0.331386f, -0.110712f, -0.270834f, -0.182713f, 0.158831f, -0.141741f, 0.010953f, -0.202270f, 0.066699f, -0.129948f, -0.250981f, -0.250250f, -0.306109f, -0.154123f, -0.158934f, -0.117197f, -0.016809f, -0.126887f, -0.337322f, 0.127717f, -0.301674f, -0.185952f, -0.275439f, 0.044736f, 0.228932f, 0.185624f, -0.081690f, -0.205979f, -0.294556f, -0.199179f, 0.012442f, -0.146571f, 0.295829f, 0.314152f, -0.058222f, -0.192916f, -0.035113f, -0.110857f, -0.206216f, -0.162990f, 0.155632f, 0.271158f, 0.017907f, -0.022688f, -0.090345f, 0.119463f, 0.050094f, -0.039985f, -0.078859f, -0.311834f, -0.201607f, 0.111127f, 0.235460f},
  {-0.567387f, -0.256985f, -0.432236f, -0.470121f, -0.171840f, 0.048113f, 0.041851f, 0.105480f, -0.099511f, 0.168704f, -0.225494f, -0.256161f, -0.018077f, -0.035255f, 0.224597f, -0.133457f, -0.088917f, -0.069064f, 0.242850f, -0.147955f, 0.094757f, -0.143201f, -0.084153f, -0.385097f, -0.001866f, 0.097063f, -0.053497f, -0.083546f, -0.140634f, -0.233540f, 0.264414f, 0.110708f, 0.186704f, -0.504826f, -0.037620f, -0.213972f, -0.146174f, -0.098308f, 0.260404f, 0.068890f, 0.224291f, -0.250469f, 0.175042f, 0.068548f, 0.199802f, -0.267633f, 0.300450f, 0.153356f, 0.045102f, 0.182812f, 0.032013f, 0.175944f, -0.086370f, -0.099335f, -0.062062f, -0.187049f, -0.009075f, -0.259331f, -0.109386f, 0.214597f, -0.183330f, -0.122787f, -0.127483f, 0.051809f, 0.120988f, -0.032620f, 0.284658f, 0.199418f, -0.078730f, -0.052545f, -0.164398f, -0.102567f, 0.046351f, -0.236528f, -0.228938f, 0.022425f, 0.057110f, -0.236666f, 0.233660f, -0.030912f, -0.027723f, 0.171897f, -0.021712f},
  {0.314292f, 0.249685f, 0.245125f, 0.080728f, -0.376919f, 0.102209f, 0.127814f, -0.055148f, 0.073377f, -0.111878f, -0.086362f, -0.371622f, -0.390872f, 0.142513f, -0.058227f, -0.198397f, -0.261207f, -0.315818f, -0.173500f, -0.088483f, -0.017425f, -0.009137f, 0.178631f, 0.049609f, 0.097413f, -0.146532f, -0.271173f, -0.099594f, -0.256378f, -0.405993f, -0.363919f, -0.203594f, -0.190348f, -0.063437f, -0.351557f, -0.251739f, 0.070897f, 0.010735f, -0.165001f, -0.112762f, -0.287562f, -0.136717f, -0.205067f, -0.334224f, -0.166355f, -0.086893f, -0.237834f, 0.075488f, 0.121243f, -0.390138f, -0.359107f, -0.232519f, -0.138298f, 0.143639f, 0.050820f, -0.050901f, -0.325748f, -0.058301f, -0.313021f, 0.077919f, -0.098441f, -0.257248f, 0.112478f, -0.077794f, -0.293338f, 0.149587f, 0.131949f, -0.083581f, -0.376752f, -0.296427f, 0.043810f, -0.111239f, -0.015830f, 0.141164f, 0.017241f, 0.097119f, -0.402084f, 0.168645f, -0.121260f, -0.036371f, -0.015071f, 0.117800f, -0.087930f},
  {-0.027027f, -0.371485f, -0.104425f, -0.470384f, 0.196427f, -0.303694f, -0.102510f, 0.153721f, -0.336942f, -0.102533f, 0.141629f, 0.202030f, -0.125205f, -0.367303f, 0.043380f, -0.279164f, -0.252357f, 0.041079f, -0.174990f, -0.050332f, -0.140858f, -0.053738f, 0.167744f, -0.285101f, 0.182977f, -0.168049f, -0.117875f, -0.012529f, -0.015678f, -0.305880f, -0.309749f, -0.236561f, -0.271948f, -0.460888f, -0.260301f, -0.199711f, 0.177898f, 0.160368f, -0.188262f, -0.159283f, 0.179618f, -0.031726f, 0.074407f, -0.109340f, 0.008862f, -0.057470f, -0.153847f, 0.225811f, -0.064727f, 0.179820f, 0.030729f, -0.338764f, -0.200573f, -0.321186f, 0.020521f, -0.049935f, -0.055656f, 0.034891f, -0.130168f, 0.033885f, -0.034543f, -0.244422f, 0.161313f, -0.056134f, -0.123185f, -0.148255f, 0.156254f, 0.261090f, 0.185155f, -0.305116f, 0.076336f, -0.001954f, -0.274340f, 0.038750f, -0.130796f, 0.155910f, 0.032673f, 0.020350f, 0.104659f, -0.262745f, -0.166507f, -0.323856f, 0.176797f},
  {0.274217f, 0.041834f, 0.328753f, 0.118412f, -0.232351f, 0.230864f, 0.064704f, -0.026006f, 0.178091f, -0.014790f, 0.336121f, -0.210941f, 0.236765f, -0.128739f, 0.010289f, 0.368758f, 0.193147f, 0.165117f, 0.209141f, -0.095264f, -0.132065f, 0.277247f, 0.025100f, -0.004311f, 0.005677f, 0.006022f, -0.139337f, 0.007381f, 0.207017f, 0.307669f, 0.141084f, -0.233474f, -0.097765f, 0.356556f, 0.099178f, 0.147306f, 0.132706f, -0.025945f, -0.191325f, -0.091613f, 0.043603f, 0.209074f, -0.086959f, 0.171721f, 0.145221f, -0.012737f, 0.249257f, -0.067667f, -0.149264f, -0.003959f, 0.011203f, 0.296420f, -0.086640f, -0.004663f, 0.373731f, 0.306155f, 0.207598f, 0.173220f, -0.113530f, -0.230844f, 0.156121f, 0.243036f, 0.105918f, 0.008329f, -0.120403f, 0.284484f, -0.181334f, -0.301488f, 0.029019f, -0.160868f, 0.329846f, 0.032331f, 0.047598f, 0.192523f, 0.159121f, 0.140464f, 0.043683f, -0.067277f, 0.143121f, 0.015390f, 0.133210f, -0.105926f, 0.312519f},
  {0.127994f, -0.132993f, 0.356200f, 0.355941f, -0.003164f, -0.136247f, 0.088564f, -0.107126f, -0.258413f, -0.198825f, -0.147228f, 0.155363f, -0.063364f, -0.251886f, 0.119721f, -0.278514f, -0.152037f, -0.140223f, -0.216724f, 0.020337f, -0.141544f, 0.354602f, 0.053763f, 0.072646f, -0.090243f, 0.019260f, 0.112228f, 0.009860f, -0.184268f, 0.079461f, 0.132316f, 0.344004f, 0.342051f, 0.362291f, -0.219118f, -0.063227f, -0.089475f, -0.078363f, -0.299565f, -0.084346f, 0.196740f, 0.133966f, 0.308013f, 0.055384f, -0.260680f, -0.313706f, 0.307715f, 0.298933f, 0.302041f, -0.101078f, 0.055277f, 0.057274f, 0.202193f, 0.155948f, -0.370172f, 0.103421f, -0.237081f, 0.273983f, -0.085223f, 0.294806f, 0.105285f, -0.083689f, -0.207412f, -0.191471f, -0.254961f, -0.358933f, 0.013835f, 0.282028f, 0.209892f, -0.122649f, -0.003728f, -0.094894f, 0.156720f, 0.076267f, -0.281931f, 0.069010f, -0.121516f, 0.291049f, 0.005409f, 0.189303f, -0.105078f, 0.052943f, 0.010745f},
  {0.138588f, 0.240390f, 0.082949f, 0.311662f, -0.146995f, -0.144709f, 0.079022f, -0.047125f, 0.153425f, 0.224175f, 0.253795f, 0.188137f, 0.241776f, 0.165498f, -0.074989f, 0.047076f, 0.077481f, 0.042413f, 0.306415f, 0.011727f, -0.185215f, 0.168512f, 0.124385f, 0.273633f, -0.213592f, 0.217452f, -0.058651f, -0.025895f, -0.120928f, -0.053747f, 0.006353f, -0.170545f, 0.038846f, 0.294434f, -0.158712f, 0.267689f, 0.268232f, -0.137570f, 0.235398f, -0.138993f, -0.186169f, 0.212380f, -0.167215f, 0.016045f, -0.088152f, 0.141344f, 0.220721f, 0.143378f, -0.126482f, 0.284418f, 0.224425f, 0.155461f, 0.239940f, -0.152352f, -0.052381f, -0.138179f, -0.066921f, 0.006376f, 0.179325f, 0.120409f, 0.053817f, -0.146207f, -0.119316f, 0.251722f, 0.154742f, -0.128586f, -0.071150f, 0.248367f, -0.159031f, 0.074209f, 0.106957f, 0.058768f, 0.118472f, -0.204736f, -0.025510f, 0.004024f, -0.047132f, -0.127776f, -0.176172f, -0.212907f, -0.204477f, 0.294240f, 0.240022f},
  {-0.278318f, 0.138726f, -0.088924f, -0.444318f, 0.015860f, -0.213979f, -0.009873f, -0.143510f, -0.225848f, -0.147366f, 0.045511f, -0.037973f, 0.028158f, -0.110873f, -0.202177f, -0.026732f, -0.225675f, 0.121870f, -0.139562f, -0.218784f, 0.129872f, -0.296359f, -0.198810f, -0.248463f, -0.108982f, 0.128555f, 0.074938f, 0.173822f, 0.016366f, 0.131039f, 0.206607f, -0.066561f, -0.061280f, -0.047504f, -0.071021f, -0.026862f, 0.067380f, 0.187404f, -0.189763f, 0.233295f, 0.078805f, 0.086854f, -0.141992f, -0.115567f, -0.091586f, -0.088923f, -0.247486f, -0.278752f, -0.305926f, -0.225331f, 0.151315f, 0.164169f, -0.156868f, 0.152843f, -0.263301f, 0.126021f, 0.263817f, -0.103535f, 0.133469f, -0.225492f, -0.203180f, -0.134306f, -0.212393f, 0.223719f, -0.042566f, 0.119945f, 0.096517f, -0.190899f, 0.121747f, -0.134686f, -0.058079f, -0.233993f, 0.177414f, 0.079011f, -0.183855f, -0.270140f, 0.180274f, -0.294992f, 0.046104f, -0.033734f, 0.275056f, 0.201578f, -0.084567f}
};

float b1[16] = {1.507583f, -1.327665f, -1.112247f, -0.771288f, 0.655890f, -0.364308f, 0.099144f, -0.513378f, 0.051517f, -0.260645f, 0.615532f, 0.668170f, 0.848368f, -1.304013f, 1.218441f, -1.480265f};

float w2[8][16] = {
  {0.468282f, 0.246201f, 0.058631f, 0.479619f, 0.084268f, 0.607941f, -0.397001f, -0.540302f, -0.599313f, -0.600828f, -0.545026f, 0.155068f, -0.456155f, 0.939841f, 0.057901f, -0.858046f},
  {-0.421473f, -0.412509f, -0.196853f, 0.752128f, 0.639801f, 0.344232f, 0.331392f, -0.648343f, 0.711143f, -0.006653f, 0.705946f, 0.254761f, -0.232078f, -0.346932f, 0.279991f, -0.219808f},
  {-0.516766f, -0.680411f, 0.757127f, -0.170996f, 0.231000f, -0.170296f, -0.767510f, -0.685092f, 0.694395f, 0.191520f, 0.270242f, 0.046793f, 0.202400f, -0.378435f, -0.510053f, -0.345146f},
  {0.600769f, 0.005285f, -0.029890f, 1.230966f, 0.378636f, 0.550454f, -0.126472f, 0.657457f, -0.431543f, 0.461447f, 0.204176f, 0.387430f, -0.119429f, 1.083237f, 0.375733f, 0.220909f},
  {0.853576f, 0.238489f, -0.004332f, 0.445574f, -0.456176f, -0.132454f, 0.572310f, -0.103557f, -0.697116f, 0.920462f, -0.695130f, 0.710303f, 0.262189f, -0.787232f, -0.192183f, 0.429390f},
  {-0.258071f, -0.331956f, 0.362053f, 0.068228f, 0.223966f, -0.888417f, -0.241949f, -0.457711f, 0.723114f, 0.507266f, 0.494531f, 0.053548f, 0.336129f, -1.232510f, -0.070726f, -0.004296f},
  {0.966070f, 0.263240f, 0.318137f, -0.094694f, -0.430269f, 0.622949f, 0.745593f, -0.340288f, -0.675663f, 0.270272f, -0.241946f, 0.360882f, -0.515800f, 0.697490f, -0.373576f, -0.288339f},
  {-0.127182f, -0.626508f, 0.741136f, -0.229868f, -0.282684f, 0.520719f, 0.097076f, -0.432463f, -0.351416f, 0.708285f, -0.130095f, 0.500798f, -0.094755f, -0.722089f, -0.623775f, 0.813208f}
};

float b2[8] = {-1.652888f, 1.030645f, 0.455056f, -0.015919f, 0.837933f, -0.358637f, 1.445182f, -1.369354f};

float w3[4][8] = {
  {-1.199739f, 0.762349f, 0.462943f, 1.119187f, 2.272488f, 0.876823f, 0.347888f, 3.040185f},
  {-0.671846f, 0.815000f, 0.662731f, -3.299629f, -1.231157f, 1.044280f, -3.092339f, -0.834558f},
  {-0.755267f, -2.625659f, -1.519851f, -1.083056f, 2.534805f, -1.836712f, 0.112896f, -1.536814f},
  {2.580787f, 0.374866f, -0.262088f, 2.342508f, -1.518453f, -0.945666f, 0.513702f, -1.888117f}
};

float b3[4] = {0.080176f, -0.310448f, 0.199369f, -0.199968f};

float mu[83] = {40.909303f, 21.514344f, 85055.347213f, 74195935.000000f, 195042.344262f, 4048062.590164f, 137672.032787f, 607935.524590f, 412767.524590f, 357016.622951f, 132318.114754f, 318638.754098f, 352836.557377f, 64842249.163934f, 143260.491803f, 1860603.737705f, 104335.229508f, 435207.819672f, 278275.508197f, 239336.327869f, 105226.934426f, 277399.983607f, 308101.442623f, 74006831.786885f, 191653.918033f, 4181321.163934f, 143612.540984f, 651656.327869f, 419002.114754f, 347095.245902f, 130989.327869f, 283004.967213f, 308026.213115f, 74102842.000000f, 214964.147541f, 4731716.393443f, 158543.311475f, 754059.918033f, 473253.655738f, 389860.409836f, 147487.852459f, 331157.721311f, 361766.344262f, 922351.967213f, 253565.606557f, 311864.065574f, 169686.901639f, 358506.000000f, 600069.836066f, 1712419.885246f, 10198873.213115f, 52361084.213115f, 8328290.065574f, 812004.409836f, 239114.475410f, 355332.344262f, 197067.918033f, 425075.049180f, 669750.770492f, 1652234.918033f, 8747411.213115f, 46747168.672131f, 6840608.295082f, 959052.901639f, 268724.229508f, 369372.180328f, 198129.704918f, 439383.360656f, 726810.819672f, 1890956.163934f, 9089091.590164f, 48469756.803279f, 7237819.868852f, 1126770.295082f, 287594.344262f, 354970.311475f, 184005.786885f, 376118.360656f, 644479.885246f, 2014092.508197f, 11310470.868852f, 51327390.114754f, 9080442.016393f};

float sigma[83] = {9.864688f, 6.369189f, 19042.790733f, 45751722.015068f, 112757.096708f, 4211313.525397f, 67444.447183f, 384975.096088f, 294962.281649f, 254291.959105f, 60588.474133f, 171148.892995f, 203952.052179f, 43626317.824220f, 87015.574232f, 2004928.129234f, 53624.628257f, 296486.635396f, 207193.730095f, 175267.331159f, 46510.997065f, 130433.661834f, 153367.271082f, 46058092.184368f, 112679.254208f, 4466611.810554f, 74054.109680f, 440819.926745f, 315856.753877f, 260017.142850f, 62514.915167f, 157234.155608f, 182058.989191f, 45903527.706349f, 118267.580596f, 5036854.702265f, 75297.170481f, 484098.618128f, 350790.438765f, 287788.941755f, 63813.111983f, 161263.124118f, 189288.995382f, 928272.845489f, 212754.244669f, 211265.745609f, 73964.789000f, 199656.111568f, 473926.167746f, 1759694.117301f, 12155619.063199f, 43991171.350818f, 9916266.089823f, 751590.202975f, 182555.630305f, 207580.367271f, 77186.243304f, 206298.634529f, 468890.650535f, 1565970.905331f, 9657739.511290f, 43202070.861653f, 7532785.145273f, 917267.517438f, 210477.228015f, 218761.072955f, 68487.663654f, 194513.042997f, 520787.033825f, 1839712.280031f, 10274354.219654f, 43699901.998405f, 8182252.297240f, 1083006.833081f, 226202.686805f, 219313.827268f, 67185.184552f, 164688.712845f, 451894.778413f, 1913541.996327f, 12548335.837269f, 43315915.769029f, 10294272.852069f};


#include <math.h>
inline void mlp_predict_vector(float xn[N_IN], float probs[N_OUT], int &pred) {
  float a1[H1];
  for (int i = 0; i < H1; ++i) {
    float z = b1[i];
    for (int j = 0; j < N_IN; ++j) z += w1[i][j] * xn[j];
    a1[i] = tanhf(z);
  }

  float a2[H2];
  for (int i = 0; i < H2; ++i) {
    float z = b2[i];
    for (int j = 0; j < H1; ++j) z += w2[i][j] * a1[j];
    a2[i] = tanhf(z);
  }

  float z3[N_OUT];
  for (int i = 0; i < N_OUT; ++i) {
    float z = b3[i];
    for (int j = 0; j < H2; ++j) z += w3[i][j] * a2[j];
    z3[i] = z;
  }

  float z_max = z3[0];
  for (int i = 1; i < N_OUT; ++i) if (z3[i] > z_max) z_max = z3[i];
  float sum = 0.f;
  for (int i = 0; i < N_OUT; ++i) {
    probs[i] = expf(z3[i] - z_max);
    sum += probs[i];
  }
  for (int i = 0; i < N_OUT; ++i) probs[i] /= sum;
  pred = 0;
  for (int i = 1; i < N_OUT; ++i) if (probs[i] > probs[pred]) pred = i;
}

#endif // MLP_MODEL_ESP32_H
